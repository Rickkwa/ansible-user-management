---

- name: Create or remove current group
  group:
    state: "{{ current_group.active | default(true) }}"  # TODO: this should also consider 'absent'. Revise 'when' condition in outer loop.
    name: "{{ current_group.name }}"
    gid: "{{ um_gid_base + current_group.rel_gid }}"
    system: no

- name: Create sudoer file associated with this group
  when: "current_group.sudoer is defined"
  copy:
    dest: "/etc/sudoers.d/rel_gid_{{ current_group.rel_gid }}"
    mode: 0440
    content: "{{ current_group.sudoer }}"
